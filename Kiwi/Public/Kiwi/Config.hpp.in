#ifndef KIWI_CONFIG_HPP
#define KIWI_CONFIG_HPP

///
/// Version
///

#define KIWI_VERSION_MAJOR @PROJECT_VERSION_MAJOR@
#define KIWI_VERSION_MINOR @PROJECT_VERSION_MINOR@
#define KIWI_VERSION_PATCH @PROJECT_VERSION_PATCH@

#define KIWI_GIT_HASH "@PROJECT_VERSION_GIT_HASH@"

#define KIWI_VERSION_NUMBER(MAJOR, MINOR, PATCH) \
    (((MAJOR << 16) | (MINOR << 8) | PATCH))

#define KIWI_VERSION \
    KIWI_VERSION_NUMBER(KIWI_VERSION_MAJOR, KIWI_VERSION_MINOR, KIWI_VERSION_PATCH)

#define KIWI_VERSION_STRING "@PROJECT_VERSION@+@PROJECT_VERSION_GIT_HASH@"

///
/// Platform
///

#if defined(_WIN32)

    #define KIWI_PLATFORM_WINDOWS 1

#elif defined(__APPLE__)

    #define KIWI_PLATFORM_APPLE 1

    #include "TargetConditionals.h"

    #if TARGET_OS_IPHONE || TARGET_IPHONE_SIMULATOR

        // Apple iOS
        #define KIWI_PLATFORM_IOS 1

    #elif TARGET_OS_MAC

        // Apple macOS/OSX
        #define KIWI_PLATFORM_MACOS 1

    #endif

#elif defined(__unix__)

    #define KIWI_PLATFORM_UNIX 1

    #if defined(__linux__)

        #define KIWI_PLATFORM_LINUX 1

    #endif

    #if defined(__ANDROID__)

        #define KIWI_PLATFORM_ANDROID 1

    #endif

#elif defined(__EMSCRIPTEN__)

    #define KIWI_PLATFORM_EMSCRIPTEN 1

#else

    #warning Unsupported Platform

#endif

///
/// Compiler
///

#if defined(_MSC_VER)

    // Microsoft VisualStudio C/C++
    #define KIWI_COMPILER_MSVC _MSC_VER

#elif defined(__clang__)

    // Apple Clang Compiler
    #define KIWI_COMPILER_CLANG __clang__

#elif defined(__INTEL_COMPILER)

    // Intel Compiler
    #define KIWI_COMPILER_ICC __INTEL_COMPILER

#elif defined(__GNUC__)
    
    // GNU Compiler Collection
    #define KIWI_COMPILER_GCC __GNUC__

#else

    #warning Unsupported Compiler

#endif

///
/// Build
///

#if defined(NDEBUG)

    #define KIWI_BUILD_RELEASE 1

#else

    #define KIWI_BUILD_DEBUG 1

#endif

///
/// Macros
///

#if KIWI_COMPILER_MSVC

    #define KIWI_FUNCTION_NAME __FUNCSIG__

#elif KIWI_COMPILER_GCC || KIWI_COMPILER_CLANG

    #define KIWI_FUNCTION_NAME __PRETTY_FUNCTION__

#else

    #define KIWI_FUNCTION_NAME __func__

#endif

#if KIWI_PLATFORM_WINDOWS

    #define KIWI_PATH_SEPARATOR '\\'
    #define KIWI_PATH_LIST_SEPARATOR ';'

#else

    #define KIWI_PATH_SEPARATOR '/'
    #define KIWI_PATH_LIST_SEPARATOR ':'

#endif

#if KIWI_COMPILER_MSVC

    #define KIWI_PACK(DECL) \
        __pragma(pack(push, 1))                                                                     \
        DECL                                                                                        \
        __pragma(pack(pop))

#else

    #define KIWI_PACK(DECL) \
        DECL __attribute__((__packed__))

#endif

#define KIWI_UNUSED(V) (void)(V)

#define _KIWI_STRINGIFY(STR) #STR
#define KIWI_STRINGIFY(STR) _KIWI_STRINGIFY(STR)

///
/// Shared Library Configuration
///

#if KIWI_COMPILER_MSVC

    #define KIWI_API_EXPORT __declspec(dllexport)
    #define KIWI_API_IMPORT __declspec(dllimport)

#else

    #if KIWI_COMPILER_GCC || KIWI_COMPILER_CLANG

        #define KIWI_API_EXPORT __attribute__ ((__visibility__ ("default")))
        #define KIWI_API_IMPORT __attribute__ ((__visibility__ ("default")))

    #endif

#endif

#if defined(KIWI_EXPORT)

    #define KIWI_API KIWI_API_EXPORT

#else

    #define KIWI_API KIWI_API_IMPORT

#endif

#endif // KIWI_CONFIG_HPP